import nilearn
import matplotlib
from nilearn import plotting
from nilearn import datasets
from nilearn import surface
from nilearn import image
from matplotlib.colors import to_rgba
import matplotlib.pyplot as plt
import string

fs = datasets.fetch_surf_fsaverage5()
#fs = datasets.fetch_surf_nki_enhanced()


tasks = ["Emotion", "Social", "Relational", "WM", "Language", "Gambling"]
task_names = {"Emotion" : "Emotion Processing",
              "Social" : "Social Cognition",
              "Relational" : "Relational Reasoning",
              "WM" : "Working Memory",
              "Language" : "Language & Math",
              "Gambling" : "Incentive Processing"}

cols = [list(to_rgba(x)) for x in \
        ["#cc00cc", "#ff9900", "#ff3333", "#00cc33", "#00ccff"]]

VOIS = ['Action', 'LTM', 'Perception', 'Procedural', 'WM']


for i, d in enumerate(sorted(tasks)):
    print("loading... " + d)
    #img = image.threshold_img(d+"/spmT_0001.nii", threshold=7.0)
    #img = image.threshold_img(d+"/spmT_0001.nii",)
    img = image.load_img(d+"/spmT_0001.nii")
    data = img.get_data()
    data[data < 0] = 0.0# Remove negative values
    img = image.smooth_img(img, fwhm=2)

    
    texture2 = surface.vol_to_surf(img, # d+"/spmT_0001.nii", #img,
                                   fs.pial_left)

    texture1 = surface.vol_to_surf(img, #d+"/spmT_0001.nii", #img
                                   fs.pial_right)

    font = {'fontname' : 'FreeSans', 'fontweight' : 'bold', 'fontsize' : 10}

    plotting.plot_surf_stat_map(fs.infl_left, texture2, hemi="left",
                                colorbar=True, view="lateral",
                                bg_map=fs.sulc_left,
                                alpha=0.75, axes = axes[i,0],
                                title = "%s, Left" % d)

    axes[i,0].set_title("(%s) %s" % (string.ascii_uppercase[i], task_names[d]), **font)


    plotting.plot_surf_stat_map(fs.infl_right, texture1,
                                colorbar=True, view="medial",
                                bg_map = fs.sulc_right,
                                alpha=0.75, axes = axes[i,1],
                                title = "%s, Right" % d)

    axes[i,1].set_title("(%s) %s" % (string.ascii_uppercase[i], task_names[d]), **font)

plt.savefig("AllVisuals.png")
